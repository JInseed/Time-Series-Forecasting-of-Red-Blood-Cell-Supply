# 시계열 분석을 활용한 적혈구제제 수급 예측
<br>

## 진행기간
> **2022/09~12**
<br>

## 사용 데이터(주최 측 제공)
> **대한적십자사 「혈액정보통계」: 2016년 1월부터 2020년 12월까지 월별 헌혈통계자료**

> **국립중앙의료원 「응급의료현황통계」: 2016년 1월부터 2020년 12월까지 중증 외상 환자 수 데이터**
<br>

## 개발 환경
> **R**
<br>

### 역할
> **자료조사, EDA, Data Processing, Modeling, 논문 작성**
<br>

## 분석 주제
> **시계열 분석을 활용한 적혈구제제 수급 예측: 여러 모델 비교(분해법, Holt Winters 가법계절지수평활법, Sarima)**
<br>

## 분석 요약

1. Data Processing
2. EDA(ACF, PACF, lag plot 등)
3. Modeling(잔차 확인, 모델 적합 후 ACF, PACF 확인, 백색잡음 검정)
    1. 분해법
        1. 잔차 확인
        2. ACF, PACF 확인
        3. 백색잡음검정(Modified Levene’s test, Anova test, t-test, Portmanteau test: Ljung-Box Q)
    2. Holt Winters 가법계절지수평활법
        1. 잔차 확인
        2. ACF, PACF 확인
        3. 백색잡음검정
    3. 계절형 ARIMA
        1. 계절 차분 후 그래프 및 ACF, PACF 확인
        2. 계절 차분 및 1차 차분 후 그래프 및 ACF, PACF 확인
        3. 차분 후 백색잡음검정
        4. 모형 적합 후 잔차 확인
        5. ACF, PACF 확인
        6. 백색잡음검정
4. 모형 선택 및 해석
<br>

## 분석 목적 및 전략
- 코로나 팬데믹 영향으로 혈액 부족 상황이 더욱 심각
- 월별헌혈 건수에서 적혈구제제공급량을, 월별 중증 외상 환자 수에서 적혈구제제수요량을 산출하여 `공급량과 수요량의 비율을 예측`하고 모형을 해석하여 특정 기간이나 시점에서 비율의 개형을 파악해 미리 혈액 부족 현상을 대비할 수 있을 것으로 기대
- 헌혈 횟수와 중증 환자 수의 변화를 분석하여 헌혈 횟수가 줄어들고 있으며 이에 대한 심각성을 통계적으로 유의하게 보여주거나 어떤 시점에 중증 환자 수가 증가하는지 등 해석 및 추가분석에 활용
- 여러 가지 분석 방법 중 `분해법`과 `Holt Winters 계절지수평활법`, 더하여 `계절형 ARIMA`를 사용하여 비교
    - 차분에 의해 데이터 포인트가 달라 RMSE로 비교
- 각 분석 방법은 차분에 의해 데이터 포인트가 달라 `RMSE`로 비교하며 계절형 ARIMA에서 차수를 정할 때, `AIC`는 관측치의 수가 적을 때 너무 많은 예측 변수를 선택하는 경향이 있으므로 이를 보완한 `AICc`를 사용하여 비교
<br>


## 분석 과정

- 시계열 예측을 통한 적혈구제제 수급 예측.pdf 에 자세히 설명됨
<br>

## 모델링 및 결과

- `분해법`의 경우 코로나 이후에 살짝 벗어난 부분이 있으나 `전체적으로 잘 적합`
- `Holt Winters 가법계절지수평활법`의 경우 코로나 이후부터 적합이 잘 안되는 모습이 보임. 이는 코로나 전후로 `양상이 변화`하였으며 해당 모형으로는 이를 고려하지 못함을 파악
- `계절형 ARIMA`의 경우도 코로나 이후부터 적합에 어려움을 보임

- 분해법을 이용한 경우의 RMSE가 가장 낮았고, 그래프 상으로도 눈에 띄게 잘 적합 되었음을 확인할 수 있음
    - `평균 수준`을 코로나의 영향에 따라 `고려`할 수 있기 때문에 나타난 결과로 해석 가능
    - 시각적으로도 뚜렷하게 추세 성분과 계절 성분이 존재함을 확인 가능하여 분해법이 적절한 분석 방법으로 가장 좋은 결과 도출
<br>

## 시사점 및 보완할 점

- 헌혈실적 중 사용된 적혈구제제의 비율, 이경원(2012)을 참고하여 적혈구제제수요량을 산출하여 `실질적인 공급 및 수요량`을 계산
- 분해법의 경우 전통적인 방법으로 이론적으로는 미흡하지만 결과적으로 가장 좋은 결과를 도출
    - 직관적인 이해와 해석이 가능하여 이를 세심하게 해석해본다면 더 다채로운 분석 결과 도출 가능할 것으로 보임
- 나머지 모형의 경우 코로나의 영향을 고려할 수 없었고 이 부분이 크게 작용하여 RMSE가 비교적 높게 나옴
    - ARIMA의 경우 차분이 필요해 데이터 소실의 단점이 존재하기도 함
- 코로나의 영향을 고려할 수 있는 `전이함수`를 활용하는 방향으로 진행한다면 각 모형의 세심한 비교가 가능할 것으로 보임
- 헌혈 건수에서 적혈구제제공급량과 수요량으로 변환하는 과정에서 정확히 중증외상환자에게 공급되는 비율과 필요한 비율을 계산할 수 있다면 좀 더 즉각적으로 헌혈이 필요한 때를 예측할 수 있을 것
<br>

## 참고문헌

> 이경원. (2012). 응급의료센터에서 수혈을 시행한 성인 외상환자에서 사망 예측 인자. 대한외상학회지, 25(3), 79-86.

> 김승우, 이평연, 권상욱 and 김종훈. (2022). 시계열 모델 기반의 계절성에 특화된 S-ARIMA모델을 사용한 리튬이온 배터리의 노화 예측 및 분석. 전력전자학회 논문지, 27(4), 316-324.

> 이정현, 송규원, 임윤정 and 조민상. (2022). 수돗물 수질 이상 탐지를 위한 수질 시계열 예측 모형 개발. 정보과학회 컴퓨팅의 실제 논문지, 28(9), 465-473.
